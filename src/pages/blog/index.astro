---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Navigation from '../../components/Navigation.astro';
import CTA from '../../components/CTA.astro';
import Footer from '../../components/Footer.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const posts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const baseUrl = import.meta.env.BASE_URL;
---

<BaseLayout title="Health Blog — HealthCarePlus" description="Stay informed with health tips, medical news, and wellness advice from our expert physicians.">
  <Navigation />

  <!-- Blog Hero -->
  <section class="blogHero">
    <div class="container">
      <div class="heroText" data-reveal>
        <h1>Health & Wellness Blog</h1>
        <p class="lead">
          Expert health advice, wellness tips, and medical insights from our team of physicians.
        </p>
      </div>
    </div>
  </section>

  <!-- Blog Posts -->
  <section class="blogPosts">
    <div class="container">
      <div class="postsGrid" data-reveal-stagger>
        {posts.map((post) => (
          <article class="postCard">
            <div class="postImage">
              <img
                src={post.data.image}
                alt={post.data.title}
                loading="lazy"
                transition:name={`blog-${post.slug}`}
              />
              <div class="postCategory" transition:name={`category-${post.slug}`}>
                {post.data.category}
              </div>
            </div>
            <div class="postContent">
              <div class="postMeta">
                <span class="postAuthor">{post.data.author}</span>
                <span class="postDate">{post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
              </div>
              <h3>
                <a href={`${baseUrl}blog/${post.slug}/`}>
                  <span transition:name={`title-${post.slug}`}>{post.data.title}</span>
                </a>
              </h3>
              <p>{post.data.description}</p>
              <a href={`${baseUrl}blog/${post.slug}/`} class="readMore">
                Read Article
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                  <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
              </a>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>

  <CTA />
  <Footer />
</BaseLayout>

<style>
  .blogHero {
    padding: calc(var(--space-16) + 80px) 0 var(--space-12);
    text-align: center;
  }

  .heroText {
    max-width: 720px;
    margin: 0 auto;
  }

  .heroText h1 {
    margin-bottom: var(--space-5);
  }

  .lead {
    font-size: var(--text-xl);
    margin: 0 auto;
  }

  .blogPosts {
    padding: var(--space-12) 0 var(--space-16);
  }

  .postsGrid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
    gap: var(--space-8);
  }

  .postCard {
    background: var(--surface);
    border-radius: var(--radius-xl);
    overflow: hidden;
    transition: transform 0.3s var(--ease-out), box-shadow 0.3s var(--ease-out);
  }

  .postCard:hover {
    transform: translateY(-8px);
    box-shadow: 0 16px 32px rgba(0, 0, 0, 0.1);
  }

  .postImage {
    position: relative;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    background: var(--border);
  }

  .postImage img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s var(--ease-out);
  }

  .postCard:hover .postImage img {
    transform: scale(1.05);
  }

  .postCategory {
    position: absolute;
    top: var(--space-4);
    left: var(--space-4);
    padding: var(--space-2) var(--space-3);
    background: var(--primary);
    color: white;
    font-family: var(--font-heading);
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: var(--radius-sm);
  }

  .postContent {
    padding: var(--space-6);
  }

  .postMeta {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
    font-size: var(--text-sm);
    color: var(--text-muted);
  }

  .postAuthor {
    font-weight: 600;
    color: var(--primary);
  }

  .postDate::before {
    content: '•';
    margin-right: var(--space-3);
  }

  .postCard h3 {
    font-size: var(--text-2xl);
    margin-bottom: var(--space-3);
  }

  .postCard h3 a {
    color: var(--text);
    transition: color 0.2s var(--ease-out);
  }

  .postCard h3 a:hover {
    color: var(--primary);
  }

  .postCard p {
    font-size: var(--text-base);
    margin-bottom: var(--space-5);
    line-height: 1.6;
  }

  .readMore {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    font-family: var(--font-heading);
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--primary);
    transition: gap 0.2s var(--ease-out);
  }

  .readMore:hover {
    gap: var(--space-3);
  }

  @media (max-width: 768px) {
    .postsGrid {
      grid-template-columns: 1fr;
    }
  }
</style>
